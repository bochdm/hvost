<!DOCTYPE html>
<!--
  Name: Jednotka - Multipurpose Template
  Author: http://themeforest.net/user/BublinaStudio
  Version: 1.0
-->
<!--[if lt IE 9]> <html class="lt-ie9" lang="en"> <![endif]-->
<!--[if !IE] -->
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout">
  <!-- <![endif] -->
  <head lang="ru">
    <title>Проект "Активный гражданин"</title>
    <meta content='blog, business, clean, multipurpose template, twitter bootstrap 3, responsive' name='keywords'/>
    <meta content='Jednotka is multipurpose Twitter Bootstrap 3 template which is suitable for any type of business or online project. ' name='description'/>
    <meta content='BublinaStudio.com' name='author'/>
    <meta content='all' name='robots'/>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'/>
    <meta content='width=device-width, initial-scale=1.0' name='viewport'/>

    <th:block layout:fragment="cascasestyles">
      <link th:href="@{/resources/css/dropzone.css}" rel="stylesheet"/>
      <link th:href="@{/resources/css/notify/ns-default.css}" rel="stylesheet"/>
      <link th:href="@{/resources/css/notify/ns-style-growl.css}" rel="stylesheet"/>
      <link th:href="@{/resources/css/wysihtml5/bootstrap3-wysihtml5-editor.css}" media="all" rel="stylesheet" type="text/css"/>

    </th:block>
  </head>
  <body class='faq-page'>
    <div id='wrapper'>

      <main layout:fragment="content">

      <div id='main' role='main'>
        <div id='main-content-header'>
          <div class='container'>
            <div class='row'>
              <div class='col-sm-12'>
                <h1 class='title'>
                  Приемная
                  <small>У серьезного человека немного вопросов, но они заданы с желанием понять и начать действовать</small>
                </h1>
              </div>
            </div>
          </div>
        </div>
        <div id='main-content'>
          <div class='container'>
            <div class='row vertical-center'>
              <div class="col-sm-6 btn-group-vertical">
                <a class="btn btn-contrast btn-md mg-b-md" th:href="@{'#askme'}" th:text="#{ask.question}"/>
                <a class="btn btn-contrast btn-md mg-b-md" th:href="@{/activepeople/unaswered}" th:text="#{queque.question}"/>

               <!-- <p th:text="${#vars['redirect']}"/>-->

              </div>
              <div class="col-sm-6">
                <blockquote>
                  <p class='text-justify small'>Умение задавать вопросы как качество личности – способность посредством правильно заданных вопросов достигнуть взаимопонимания, добиться исполнения своих желаний, добраться до истины, получить информацию, выразить сомнения, проявить собственную позицию, выказать доверие и заинтересованность в сказанном.</p>
                </blockquote>
              </div>
            </div>

            <div class='row'>
              <div class='col-sm-12'>
                <div class='row'>
                  <div class='col-sm-12'>
                    <form th:action="@{/activepeople/search}" class='mg-b' method='post'>
                      <div class='input-group'>
                        <input id="q" name="q" class='form-control' placeholder='Поиск по вопросам и ответам...' type='text'/>
                        <span class='input-group-btn'>
                          <button class='btn btn-contrast btn-block' type="submit">
                            <i class='fa-icon-search'></i>
                          </button>
                        </span>
                      </div>
                    </form>
                  </div>
                </div>

                <div class="row" th:each="answer : ${answers}" th:id="${answer.id}">
                  <hr class='hr-half'/>
                  <div class="col-sm-6">
                    <!--<p class='dropcap-contrast'><span class='first-letter'>В</span></p>-->

                      <p class='text-justify' th:text="${answer.question.questionText}"/>
                      <small>
                        <div class="toolbar">
                          <a class='' th:href="@{/}">
                            <i class="fa-icon-calendar-empty"></i>
                            <time th:datetime-local="ru" th:datetime="${answer.question.date}" th:text='${#dates.format(answer.question.date, "dd MMMM yyyy HH:mm")}'/>
                          </a>
                          <a class='' href='#'>
                            <i class='fa-icon-user'></i>
                            <span th:text="${answer.question.author}"/>
                          </a>
                          <a  class='' th:href="@{/}">
                            <span>Категория: <span th:text="${answer.question.category.name}"/></span>
                          </a>
                        </div>
                      </small>

                  </div>
                  <div class="col-sm-6">
                    <blockquote>
                      <p class="text-justify" th:utext="${answer.answerText}"/>
                      <small>
                        <time th:datetime-local="ru" th:datetime="${answer.date}" th:text='${#dates.format(answer.date, "dd MMMM yyyy HH:mm")}'/>
                      </small>
                    </blockquote>
                  </div>

                </div>

                <!--Старая версия-->
                <!--<div class='panel-group accordion accordion-bordered' id='accordion'>-->

                  <!--<div th:each="answer : ${answers}" class='panel panel-default'>-->
                    <!--<div class='panel-heading'>-->
                      <!--<h4 class='panel-title'>-->
                        <!--<a class='accordion-toggle' data-parent="#accordion" data-toggle='collapse' th:text="${answer.question.questionText}" th:href="@{'#accordion-item-'+${answer.id}}"/>-->
                      <!--</h4>-->
                    <!--</div>-->
                    <!--<div class='panel-collapse' id='accordion-item-1' th:id="@{'accordion-item-'+${answer.id}}">-->
                      <!--<div class="toolbar">-->
                        <!--<a class='btn btn-link btn-xs' th:href="@{/}">-->
                          <!--<i class="fa-icon-calendar-empty"></i>-->
                          <!--<time th:datetime-local="ru" th:datetime="${answer.question.date}" th:text='${#dates.format(answer.question.date, "dd MMMM yyyy HH:mm")}'/>-->
                        <!--</a>-->
                        <!--<a class='btn btn-link btn-xs' href='#'>-->
                          <!--<i class='fa-icon-user'></i>-->
                          <!--<span th:text="${answer.question.author}"/>-->
                        <!--</a>-->
                        <!--<a class='btn btn-link btn-xs'  th:href="@{/}">-->
                          <!--<span>Категория: <span th:text="${answer.question.category.name}"/></span>-->
                        <!--</a>-->
                      <!--</div>-->
                      <!--<div class='panel-body'>-->
                        <!--<time th:datetime-local="ru" th:datetime="${answer.date}" th:text='${#dates.format(answer.date, "dd MMMM yyyy HH:mm")}'/>-->

                        <!--<p th:utext="${answer.answerText}"/>-->
                      <!--</div>-->
                    <!--</div>-->
                  <!--</div>-->
                <!--</div>-->

                <hr class="hr-half"/>

              </div>
            </div>


            <!-- Paging -->
            <nav>
              <ul class="pagination pagination-sm">
                <li th:if="${paginationInfo.previousVisible}">
                  <a th:href="@{'/activepeople/'(page=${paginationInfo.previousPageNumber})}" >
                    <i class="fa-icon-angle-left"/>
                  </a>
                </li>

                <li th:each="element : ${paginationInfo.pageElement}" >

                <li  th:if="${element.navigable}">
                  <a th:href="@{'/activepeople/'(page=${element.label})}" th:text="${element.label}" />
                </li>
                <li th:if="${!element.navigable and element.currentPage}" class="active">
                  <a class="disabled" th:text="${element.label}" />
                </li>
                <li th:unless="${element.navigable or element.currentPage}">
                  <a th:text="${element.label}" />
                </li>
                </li>
                <li th:if="${paginationInfo.nextVisible}">
                  <a th:href="@{'/activepeople/'(page=${paginationInfo.nextPageNumber})}">
                    <i class="fa-icon-angle-right"/>
                  </a>
                </li>
              </ul>
            </nav>

            <div class='row' id="askme">
              <form id="send-question" th:action="@{/activepeople/addquestion}" th:object="${question}"
                    class='form dropzone' method='post' enctype="multipart/form-data"
                    style="border:none;background-color: transparent;">
              <div class='page-header page-header-with-icon'>
                <i class='fa-icon-question-sign'></i>
                <h2>Не смогли найти ответ? Задайте&nbsp;свой&nbsp;вопрос!</h2>
              </div>
              <div class='col-sm-6'>
                  <fieldset>
                    <div class='row'>
                      <div class='col-sm-6'>
                        <div class='form-group'>
                          <input class='form-control' th:field="*{author}" data-rule-required='false' id='author' name='author' placeholder='Ваше имя' type='text'/>
                        </div>
                      </div>
                      <div class='col-sm-6'>
                        <div class='form-group'>
                          <input class='form-control' id='contact_email'
                                  name='contact_email' placeholder='Ваш E-Mail' type='email'/>
                        </div>
                      </div>
                    </div>
                    <div class='row'>
                      <div class='col-sm-12'>
                        <div class='form-group'>
                          <textarea class='form-control' id='questionText' name='text_question' placeholder='Ваш вопрос...' rows='14' th:field="*{questionText}"/>
                          <td th:if="${#fields.hasErrors('questionText')}" class="text-danger" th:errors="*{questionText}">Name Error</td>
                        </div>
                      </div>
                    </div>
                    <div class='row'>
                      <div class='col-sm-12'>
                          <button id="newQuestion" name="newQuestion" class='btn btn-contrast btn-block' type="button" th:text="#{ask.question}"/>
                      </div>
                    </div>
                  </fieldset>

              </div>
              <div class="col-sm-6">
                <div class="col-md-12 col-sm-12 col-xs-12">
                  <div class="x_panel">
                    <div class="x_content">

                      <p>Перенесите файлы изображений в область ниже или кликните на ней</p>
                      <div id="dropzonePreview" class="dz-default dz-message form-control" style="height: 360px; ">
                        <div id="preview">
                          <span class="preview"><img data-dz-thumbnail="" /></span>
                        </div>
                      </div>


                    </div>
                  </div>
                </div>
              </div>
              </form>
            </div>

          </div>
        </div>
        <div class='fade' id='scroll-to-top'>
          <i class='fa-icon-chevron-up'></i>
        </div>
      </div>

      </main>

    </div>

    <th:block layout:fragment="script">
      <script th:src="@{/resources/js/jquery/jquery.validate.min.js}" type="text/javascript"></script>
      <script th:src="@{/resources/js/jquery/jquery.blockui.js}"      type="text/javascript"></script>
      <script th:src="@{/resources/js/pages/activepeople.js}"         type="text/javascript"></script>
      <script th:src="@{/resources/js/bootbox.min.js}"                type="text/javascript"></script>
      <script th:src="@{/resources/js/admin/dropzone.js}"             type="text/javascript"></script>

      <script th:src="@{/resources/js/notify/classie.js}"             type="text/javascript"></script>
      <script th:src="@{/resources/js/notify/notificationFx.js}"      type="text/javascript"></script>


      <script th:inline="javascript">
        /*<![CDATA[*/
        var isRedirect = /*[[${#vars['redirect']}]]*/;
        console.log("isRedirect =" + isRedirect);
        if (isRedirect === '1'){
          // create the notification
          var notification = new NotificationFx({
            message : '<p style="color:white">Спасибо за Ваш вопрос!<br/> Мы постараемся ответить Вам в ближайшее время</p>',
            layout : 'growl',
            effect : 'scale',
            type : 'notice', // notice, warning or error
            ttl  : 7500,
            onClose : function() {
           //   $('#newQuestion').disabled = false;
            }
          });

          notification.show();

          $.unblockUI();
        }
        /*]]>*/
      </script>

      <script th:inline="javascript">


        /*<![CDATA[*/
        Dropzone.options.sendQuestion = { // The camelized version of the ID of the form element

          clickable:'#dropzonePreview',
          previewsContainer: '#preview',
          autoProcessQueue: false,
          uploadMultiple: true,
          parallelUploads: 10,
          maxFiles: 6,
          addRemoveLinks: true,
          maxFilesize: 1,
          dictRemoveFile: 'Удалить файл',
          dictFileTooBig: 'Файл слишком большой, уменьшите размер до 1 Mb',


          // The setting up of the dropzone
          init: function() {
            var myDropzone = this;
            var submitButton = document.querySelector('#newQuestion');
            var submitForm = document.querySelector('#send-question');

            submitButton.addEventListener("click", function(e) {
              var valid = $('#send-question').valid();
              if (valid === true) {
                e.preventDefault();
                e.stopPropagation();
                $.blockUI({
                  message: 'Пожалуйста, подождите',
                  baseZ: 99999999999999999,
                  css: {
                    border: 'none',
                    padding: '15px',
                    backgroundColor: '#000',
                    '-webkit-border-radius': '10px',
                    '-moz-border-radius': '10px',
                    opacity: .3,
                    color: '#fff'
                  }
                });

                submitButton.disable = true;

                if (myDropzone.getQueuedFiles().length > 0) {

                  myDropzone.processQueue();

                } else {

                  setTimeout(function () {
                    submitForm.submit();
                  }, 300);

                  submitButton.disable = false;
                }
              }
            });

            this.on("error", function(files, message){
              alert(message);
            });

            this.on("successmultiple", function(files, response) {

              $.unblockUI();

              //window.location.href = /*[[@{/activepeople}]]*/;
              console.log("successmultiple ");

              // create the notification
              var notification = new NotificationFx({
                message : '<p style="color:white">Спасибо за Ваш вопрос!<br/> Мы постараемся ответить Вам в ближайшее время</p>',
                layout : 'growl',
                effect : 'scale',
                type : 'notice', // notice, warning or error
                ttl  : 7000,
                onClose : function() {
                  submitButton.disabled = false;
                }
              });

              notification.show();
            });
            this.on("complete", function(file) {
              $("#send-question").get(0).reset();
              myDropzone.removeFile(file);
            });

          }

        }

        /*]]>*/
      </script>

    </th:block>

  </body>
</html>
